---
title: "Emotional Attributes of diverging political spheres on Twitter"
author: "Florian Klement, David Siegl, Shirin Yanni"
output:
  html_document:
    df_print: paged
  pdf_document: default
---


```{r}
library(rtweet)
library(ggplot2)
library(tidyverse)
library(gsubfn)
library(quanteda)
library(quanteda.textplots)
library(wordcloud2)
library(arules)
library(lubridate)
library(patchwork)
library(ggrepel)
```

<b>Accessing the Twitter-API</b>
```{r}
consumerKey = "X"
consumerSecret = "X"
accessToken = "X-X"
accessSecret = "X"
options(httr_oauth_cache=TRUE)
twitter_token <- create_token(
  consumer_key = consumerKey,
  consumer_secret = consumerSecret,
  access_token = accessToken,
  access_secret = accessSecret)
```


<b>Loading some data</b>
```{r}
sheet <- read.csv("./Emotion Analysis - Twitter.csv")
id_list <- as.list(sheet$Twitter.ID)
```


<b>Defining Function for Twitter-Scraping</b>
```{r}
scrape_tweets <- function(userID, n_tweets, filename){
  tweets <- get_timeline(userID, n_tweets, include_rts=FALSE, exclude_replies=TRUE)
  tweets_df <- as_data_frame(tweets)
  tweets_df <- tweets_df %>%
    select(c(status_id, text, screen_name, created_at, favorite_count, retweet_count))
  write.csv(tweets_df, paste(filename,"-tweets.csv", sep = ""), row.names = FALSE)
}

# for (id in id_list) {
#   scrape_tweets(id, 3200, id)
# }
```


<b>Loading the Tweets</b>
```{r}
tweets_files <- list.files("./data/raw")

for (i in 1:length(tweets_files)) {                              
  assign(paste0("tweets_", i),                                   
         read.csv(paste0("./data/raw/",
                   tweets_files[i])))
}
```


<b>Preprocessing</b>
```{r}
tweets_1 <- top_n(tweets_1, 300, created_at) #sampling the tweets for n=300
tweets_2 <- top_n(tweets_2, 300, created_at)
tweets_4 <- top_n(tweets_4, 300, created_at)
tweets_5 <- top_n(tweets_5, 300, created_at)
tweets_6 <- top_n(tweets_6, 300, created_at)
tweets_7 <- top_n(tweets_7, 300, created_at)
tweets_8 <- top_n(tweets_8, 300, created_at)
tweets_9 <- top_n(tweets_9, 300, created_at)
tweets_10 <- top_n(tweets_10, 300, created_at)
tweets_11 <- top_n(tweets_11, 300, created_at)
tweets_12 <- top_n(tweets_12, 300, created_at)
tweets_13 <- top_n(tweets_13, 300, created_at)
tweets_14 <- top_n(tweets_14, 300, created_at)
tweets_15 <- top_n(tweets_15, 300, created_at)
tweets_16 <- top_n(tweets_16, 300, created_at)
```


```{r}
cleaning_tweets <- function(text){
  text <- gsub("http.+", "", text)
  text <- gsub(",", "", text)
  text <- gsubfn(pattern = "[[:punct:]]", engine = "R",
       replacement = function(x) ifelse(x == "#", "#", ""), 
       text)
  text <- gsub("[[:digit:]]", "", text)
  text <- gsub("  ", " ", text)
  text <- tolower(text)
}
```


```{r}
df_full <- rbind(tweets_1, tweets_2, tweets_3, tweets_4, tweets_5, tweets_6, tweets_7, tweets_8, tweets_9, tweets_10, tweets_11, tweets_12, tweets_13, tweets_14, tweets_15, tweets_16, by = (c("status_id", "text", "screen_name", "created_at", "favorite_count", "retweet_count")), all = TRUE)

unique(df_full$screen_name)

df_full <- df_full %>%
  filter(screen_name != TRUE) %>%
  filter(screen_name != "screen_name")
 
unique(df_full$screen_name)

df_full <- df_full %>%
  rowwise() %>%
  mutate(text_clean = cleaning_tweets(text)) %>%
  mutate(date = as.Date(created_at))

write.csv(df_full, "./data/clean/tweets_clean.csv", row.names = FALSE)
```


```{r}
tweets_clean <- read.csv("./data/clean/tweets_clean.csv")

join_info <- sheet %>%
  mutate(screen_name = gsub("@", "", Twitter.ID))

tweets_clean_joined <- left_join(tweets_clean, join_info, by = "screen_name")
tweets_clean_joined <- tweets_clean_joined %>%
  select(-c(Link, Follower, Notes, Twitter.ID))
tweets_clean_joined <- rename(tweets_clean_joined, name = Name, party = Party, country = Country, left_right = left.right)

write.csv(tweets_clean_joined, "./data/clean/tweets_clean_joined.csv", row.names = FALSE)
```


<b>Joining the emotion dictionary</b>
```{r}
tweets_clean_joined <- read.csv("./data/clean/tweets_clean_joined.csv")

stopwords_de <- stopwords("german")
stopwords_add <- c("dass", "„", "–")
stopwords_de <- append(stopwords_de, stopwords_add)

dict <- read_tsv("./dict/de.tsv")
dict$word <- tolower(dict$word)
```


```{r}
tweets_words <- function(text){
  words <- strsplit(text, " ")[[1]]
  tf <- table(words)           
  tf <- as.data.frame(tf)
  colnames(tf) <- c("word", "frequency")
  tf <- subset(tf, is.element(word, stopwords_de) == FALSE)
  return(tf)
}

join_dict_valence <- function(words, dict){
  tf <- tweets_words(text)
  combined <- merge(tf, dict, by="word")
  score_valence <- sum(combined$frequency * combined$valence) / sum(combined$frequency)
  return(score_valence)
}

join_dict_arousal <- function(words, dict){
  tf <- tweets_words(text)
  combined <- merge(tf, dict, by="word")
  score_arousal <- sum(combined$frequency * combined$arousal) / sum(combined$frequency)
  return(score_arousal)
}

join_dict_dominance <- function(words, dict){
  tf <- tweets_words(text)
  combined <- merge(tf, dict, by="word")
  score_dominance <- sum(combined$frequency * combined$dominance) / sum(combined$frequency)
  return(score_dominance)
}
```


<b>Getting valence, arousal and dominance score for all users</b>
```{r}
# texts <- paste(tweets_clean_joined$text_clean, tweets_clean_joined$text_clean, sep = " ")
# valence_scores <- c()
# arousal_scores <- c()
# dominance_scores <- c()
# 
# for(i in 1:nrow(tweets_clean_joined)){
#     text <- texts[i]
#     scores <- join_dict_valence(text, dict)
#     valence_scores <- c(valence_scores, scores)
# }
```


```{r}
# for(i in 1:nrow(tweets_clean_joined)){
#     text <- texts[i]
#     scores <- join_dict_arousal(text, dict)
#     arousal_scores <- c(arousal_scores, scores)
# }
```


```{r}
# for(i in 1:nrow(tweets_clean_joined)){
#     text <- texts[i]
#     scores <- join_dict_dominance(df, dict)
#     dominance_scores <- c(dominance_scores, scores)
# }
```


```{r}
# tweets_clean_joined_emo <- cbind(tweets_clean_joined, valence_scores, arousal_scores, dominance_scores)
# tweets_clean_joined_emo <- rename(tweets_clean_joined_emo, valence = valence_scores, arousal = arousal_scores, dominance = dominance_scores)
# write.csv(tweets_clean_joined_emo, "./data/clean/tweets_clean_joined_emo.csv", row.names = FALSE)
```


<b>Some scatter plots</b>
```{r}
tweets_clean_joined_emo <- read.csv("./data/clean/tweets_clean_joined_emo.csv")

ggplot(data = tweets_clean_joined_emo, aes(x = arousal, y = retweet_count)) +
  geom_point() +
  scale_y_continuous(trans='log10') +
  scale_x_continuous(trans='log10')

ggplot(data = tweets_clean_joined_emo, aes(x = valence, y = retweet_count)) +
  geom_point() +
  scale_y_continuous(trans='log10') +
  scale_x_continuous(trans='log10')

ggplot(data = tweets_clean_joined_emo, aes(x = dominance, y = retweet_count)) +
  geom_point() +
  scale_y_continuous(trans='log10') +
  scale_x_continuous(trans='log10')
```


```{r}
id_list <- gsub("@", "", id_list) #creating a list with all user subsets, in case we need to loop over it - might delete later

for(i in id_list){
 assign(paste0("tweets_user_", i),
        tweets_clean_joined_emo %>%
  filter(screen_name == i))
}

list_var <- ls(pattern = "tweets_user_*")
```


<b>Quanteda Analysis</b>
```{r}
corp_tweet <- corpus(tweets_clean_joined_emo, text_field = "text_clean")

corpus_DIEGRUENEN <- corp_tweet %>% 
  corpus_subset(party == "BUENDNIS 90/DIE GRUENEN")

corpus_GRUENE <- corp_tweet %>% 
  corpus_subset(party == "GRUENE")

corpus_AfD <- corp_tweet %>% 
  corpus_subset(party == "AfD")

corpus_FPOE <- corp_tweet %>% 
  corpus_subset(party == "FPOE")

get_dfm <- function(corpus){
tok_tweet <- tokens(corpus)
tok_clean <- tokens_remove(tok_tweet, pattern = stopwords("german"))
stopwords_2 <- c("dass", "„", "–")
tok_clean <- tokens_select(tok_clean, pattern = stopwords_2, selection = "remove")
tweet_matrix <- dfm(tok_clean)
return(tweet_matrix)
}
```


```{r}
set.seed(1234)
DIEGRUENEN_dfm <- get_dfm(corpus_DIEGRUENEN)
textplot_wordcloud(DIEGRUENEN_dfm, max_words = 300, min_size = 0.7, min_count = 5, color = "darkgreen")
```
```{r}
set.seed(1234)
corpus_GRUENE_dfm <- get_dfm(corpus_GRUENE)
textplot_wordcloud(corpus_GRUENE_dfm, max_words = 300, min_size = 0.7, min_count = 5, color = "darkgreen")
```


```{r}
set.seed(1234)
AfD_dfm <- get_dfm(corpus_AfD)
textplot_wordcloud(AfD_dfm, max_words = 300, min_size = 0.9, min_count = 5, color = "darkblue")
```


```{r}
set.seed(1234)
FPOE_dfm <- get_dfm(corpus_FPOE)
textplot_wordcloud(FPOE_dfm, max_words = 300, min_size = 0.7, min_count = 5, color = "darkblue")
```

<b>Wordcloud comparison</b>
```{r}
comp_tweets_1 <- tweets_clean_joined_emo %>%
  filter(left_right == 1)

comp_tweets_2 <- tweets_clean_joined_emo %>%
  filter(left_right == 0)

paste_right <- paste(comp_tweets_1$text_clean, collapse = " ")
paste_left <- paste(comp_tweets_2$text_clean, collapse = " ")
left_right <- c(0, 1)

df_comp <- data.frame(text = character(0), left_right = numeric(0))
df_comp <- rbind(df_comp, paste_right, paste_left)
df_comp <- cbind(df_comp, left_right)
colnames(df_comp) <- c("text", "left_right")
rownames(df_comp) <- c( "right", "left")

corp_comp <- corpus(df_comp, text_field = "text")

comp_dfm <- get_dfm(corp_comp)

textplot_wordcloud(dfm_trim(comp_dfm, dmin_count = 5, verbose = FALSE), max_words = 300, min_size = 0.7, min_count = 5, labelcolor = "black", rotation = 1,
                   comparison = TRUE, color = c("darkblue", "darkgreen")) #for usage in presentation rotate 90°
```

<b>Descriptive Statistics</b>
```{r}
tweets_emo_avg <-
  tweets_clean_joined_emo %>%
  group_by(party) %>%
  summarize(mean_valence = mean(valence, na.rm = T),
            mean_arousal = mean(arousal, na.rm = T),
            mean_dominance = mean(dominance, na.rm = T),
            median_valence = median(valence, na.rm = T),
            median_arousal = median(arousal, na.rm = T),
            median_dominance = median(dominance, na.rm = T),
            sd_valence = sd(valence, na.rm = T),
            sd_arousal = sd(arousal, na.rm = T),
            sd_dominance = sd(dominance, na.rm = T))
tweets_emo_avg #only confirming Nullhypothesis - no significant deviations between left and right or party
```

```{r}

party_l = c("FPOE", "AfD", "GRUENE", "BUENDNIS 90/DIE GRUENEN")
tweets_afd <- tweets_clean_joined_emo %>%
  filter(party == "AfD")

tweets_fpoe <- tweets_clean_joined_emo %>%
  filter(party == "FPOE")

tweets_groe <- tweets_clean_joined_emo %>%
  filter(party == "GRUENE")

tweets_grde <- tweets_clean_joined_emo %>%
  filter(party == "BUENDNIS 90/DIE GRUENEN")
```


```{r}
summary(tweets_afd)
```
```{r}
summary(tweets_fpoe)
```


```{r}
summary(tweets_grde)
```


```{r}
summary(tweets_groe)
```


<b>Temporal Discretisation</b>
```{r}
xy <- today()
date_numeric <- function(date) {
  date <- as.Date(date)
span <- interval(ymd(date), ymd(xy))
num <- as.duration(span)
return(num)}
date_numeric('2020-08-20')
```


```{r}
tweets_emo_disc <- tweets_clean_joined_emo %>%
  mutate(age = date_numeric(date)) #binning time series data for line plots
```


```{r}
tweets_emo_bin <- tweets_emo_disc 
tweets_emo_bin$date_disc <-
discretize(tweets_emo_disc$age, method = "frequency", breaks = 20, include.lowest = TRUE)
```


```{r}
length(unique(tweets_emo_bin$date_disc))
```


```{r}
tweets_disc_afd <- tweets_emo_bin %>%
  filter(party == "AfD") %>%
  drop_na()

tweets_disc_fpoe <- tweets_emo_bin %>%
  filter(party == "FPOE")%>%
  drop_na()

tweets_disc_groe <- tweets_emo_bin %>%
  filter(party == "GRUENE")%>%
  drop_na()

tweets_disc_grde <- tweets_emo_bin %>%
  filter(party == "BUENDNIS 90/DIE GRUENEN")%>%
  drop_na()
```


 <b>Violin Plots for emotional distributions</b>
```{r}
violinplot_afd_valence <- 
  ggplot(tweets_disc_afd, aes(x = name, y = valence, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Valence") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_afd_dominance <- 
  ggplot(tweets_disc_afd, aes(x = name, y = dominance, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Dominance") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
  
violinplot_afd_arousal <- 
  ggplot(tweets_disc_afd, aes(x = name, y = arousal, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Arousal") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

afd_comparison <- violinplot_afd_valence + violinplot_afd_dominance + violinplot_afd_arousal
```


```{r}
violinplot_fpoe_valence <- 
  ggplot(tweets_disc_fpoe, aes(x = name, y = valence, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Valence") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_fpoe_dominance <- 
  ggplot(tweets_disc_fpoe, aes(x = name, y = dominance, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Dominance") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_fpoe_arousal <- 
  ggplot(tweets_disc_fpoe, aes(x = name, y = arousal, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Arousal") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))


fpoe_comparison <- violinplot_fpoe_valence + violinplot_fpoe_dominance + violinplot_fpoe_arousal
```


```{r}
violinplot_groe_valence <- 
  ggplot(tweets_disc_groe, aes(x = name, y = valence, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Valence") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_groe_dominance <- 
  ggplot(tweets_disc_groe, aes(x = name, y = dominance, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Dominance") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_groe_arousal <- 
  ggplot(tweets_disc_groe, aes(x = name, y = arousal, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Arousal") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))


groe_comparison <- violinplot_groe_valence + violinplot_groe_dominance + violinplot_groe_arousal
```


```{r}
violinplot_grde_valence <- 
  ggplot(tweets_disc_grde, aes(x = name, y = valence, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Valence") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_grde_dominance <- 
  ggplot(tweets_disc_grde, aes(x = name, y = dominance, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Dominance") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))

violinplot_grde_arousal <- 
  ggplot(tweets_disc_grde, aes(x = name, y = arousal, fill = name, color = name )) +
  geom_violin(color = NA, alpha = 1, trim=TRUE, size=20) +
  
  geom_boxplot(size =1, width=0.1) +
   xlab("\n Politician ") +
   ylab("\n Arousal") +
  theme_classic() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))


grde_comparison <- violinplot_grde_valence + violinplot_grde_dominance + violinplot_grde_arousal
```


```{r}
grde_comparison
groe_comparison
afd_comparison
fpoe_comparison
```


<b>Lineplots over time</b>
```{r}
lineplot_valence_grde <-
  ggplot(tweets_disc_grde, aes(x=age, y=valence)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Valence over time in DIE GRUENEN") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_dominance_grde <-
  ggplot(tweets_disc_grde, aes(x=age, y=dominance)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Dominance over time in DIE GRUENEN") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_arousal_grde <-
  ggplot(tweets_disc_grde, aes(x=age, y=arousal)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Arousal over time in DIE GRUENEN") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()
```


```{r}
lineplot_valence_groe <-
  ggplot(tweets_disc_groe, aes(x=age, y=valence)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Valence over time in GRUENE") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_dominance_groe <-
  ggplot(tweets_disc_groe, aes(x=age, y=dominance)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Dominance over time in GRUENE") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_arousal_groe <-
  ggplot(tweets_disc_groe, aes(x=age, y=arousal)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Arousal over time in GRUENE") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()
```


```{r}
lineplot_valence_fpoe <-
  ggplot(tweets_disc_fpoe, aes(x=age, y=valence)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Valence over time in FPOE") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_dominance_fpoe <-
  ggplot(tweets_disc_fpoe, aes(x=age, y=dominance)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Dominance over time in FPOE") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_arousal_fpoe <-
  ggplot(tweets_disc_fpoe, aes(x=age, y=arousal)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Arousal over time in FPOE") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()
```


```{r}
lineplot_valence_afd <-
  ggplot(tweets_disc_afd, aes(x=age, y=valence)) +
  geom_line(aes(color = name), size = 1, alpha = 0.4) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Valence over time in AFD") +
  #scale_x_continuous(breaks = seq(1, 20, 2)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set1") +
  theme_minimal()

lineplot_dominance_afd <-
  ggplot(tweets_disc_afd, aes(x=age, y=dominance)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Dominance over time in AFD") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()

lineplot_arousal_afd <-
  ggplot(tweets_disc_afd, aes(x=age, y=arousal)) +
  geom_line(aes(color = name), size = 1.5) +
  xlab("\n over time") +
  ylab("Valence \n") +
  ggtitle("Arousal over time in AFD") +
  scale_x_continuous(breaks = seq(1900, 2000, 10)) +
  # Let's use the Brewer color palette 
  scale_color_brewer(type = "div", palette = "Set3") +
  theme_minimal()
```


```{r}
test <- tweets_emo_bin %>%
  filter(name == "Alice Weidel" | name == "Annalena Baerbock")

ggplot(test, aes(x=age, y=arousal)) +
  geom_line(aes(color = name), size = 1.2, alpha = 0.4) +
  xlab("\n over time") +
  ylab("Arousal \n") +
  ggtitle("Arousal over time") +
  scale_color_manual(values = c("darkblue", "darkgreen")) +
  theme_minimal()
```


```{r}
lineplot_valence_afd
lineplot_valence_fpoe
lineplot_valence_groe
lineplot_valence_grde
lineplot_dominance_fpoe
lineplot_dominance_afd
lineplot_dominance_groe
lineplot_dominance_grde
lineplot_arousal_afd
lineplot_arousal_fpoe
lineplot_arousal_groe
lineplot_arousal_grde
```


<b>T-tests</b>
```{r}
tweets_right <- tweets_emo_bin %>%
  filter(left_right == "1")

tweets_left <- tweets_emo_bin %>%
  filter(left_right == "0")
```


<b>Germany - Valence</b>
```{r}
t.test(tweets_disc_afd$valence, tweets_disc_grde$valence, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Germany - Dominance</b>
```{r}
t.test(tweets_disc_afd$dominance, tweets_disc_grde$dominance, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Germany - Arousal</b>
```{r}
t.test(tweets_disc_afd$arousal, tweets_disc_grde$arousal, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Austria - Valence</b>
```{r}
t.test(tweets_disc_fpoe$valence, tweets_disc_groe$valence, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Austria - Dominance</b>
```{r}
t.test(tweets_disc_fpoe$dominance, tweets_disc_groe$dominance, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Austria - Arousal</b>
```{r}
t.test(tweets_disc_fpoe$arousal, tweets_disc_groe$arousal, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Left/Right - Valence</b>
```{r}
t.test(tweets_right$valence, tweets_left$valence, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Left/Right - Dominance</b>
```{r}
t.test(tweets_right$dominance, tweets_left$dominance, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Left/Right - Arousal</b>
```{r}
t.test(tweets_right$arousal, tweets_left$arousal, var.equal = FALSE, alternative = "greater", conf.level = 0.95)
```


<b>Results</b>